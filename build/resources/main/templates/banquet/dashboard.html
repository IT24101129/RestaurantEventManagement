<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Banquet Hall Supervisor Dashboard - Restaurant Management</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .dashboard-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 2rem 0;
            margin-bottom: 2rem;
        }
        
        .event-card {
            border: 1px solid #dee2e6;
            border-radius: 10px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            background: white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            transition: transform 0.2s;
        }
        
        .event-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }
        
        .event-card.confirmed {
            border-left: 4px solid #28a745;
        }
        
        .event-card.pending {
            border-left: 4px solid #ffc107;
        }
        
        .event-card.cancelled {
            border-left: 4px solid #dc3545;
        }
        
        .staff-assignment {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 1rem;
            margin: 0.5rem 0;
        }
        
        .equipment-item {
            background: #e3f2fd;
            border-radius: 8px;
            padding: 0.75rem;
            margin: 0.5rem 0;
        }
        
        .conflict-alert {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
        }
        
        .resource-summary {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 1rem;
        }
        
        .status-badge {
            font-size: 0.8rem;
            padding: 0.25rem 0.5rem;
        }
        
        .real-time-indicator {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
        }
        
        .loading-spinner {
            display: none;
        }
        
        .loading-spinner.show {
            display: inline-block;
        }
    </style>
</head>
<body>
    <!-- Real-time Connection Indicator -->
    <div class="real-time-indicator">
        <div id="connectionStatus" class="badge bg-success">
            <i class="fas fa-circle me-1"></i>Live
        </div>
    </div>

    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container">
            <a class="navbar-brand" href="/dashboard">
                <i class="fas fa-utensils me-2"></i>Restaurant Management
            </a>
            <div class="navbar-nav ms-auto">
                <a class="nav-link" href="/dashboard">
                    <i class="fas fa-home me-1"></i>Dashboard
                </a>
                <a class="nav-link" href="/logout">
                    <i class="fas fa-sign-out-alt me-1"></i>Logout
                </a>
            </div>
        </div>
    </nav>

    <!-- Dashboard Header -->
    <div class="dashboard-header">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-md-8">
                    <h1><i class="fas fa-calendar-check me-2"></i>Banquet Hall Supervisor Dashboard</h1>
                    <p class="mb-0">Event Schedule Management & Resource Allocation</p>
                </div>
                <div class="col-md-4 text-end">
                    <div class="btn-group" role="group">
                        <button id="refreshData" class="btn btn-light">
                            <i class="fas fa-sync-alt me-1"></i>Refresh
                        </button>
                        <button id="checkConflicts" class="btn btn-warning">
                            <i class="fas fa-exclamation-triangle me-1"></i>Check Conflicts
                        </button>
                        <a href="/events/booking" class="btn btn-outline-light">
                            <i class="fas fa-plus me-1"></i>New Event
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="container-fluid">
        <!-- Error/Success Messages -->
        <div id="alertContainer"></div>

        <!-- Date Range Selector -->
        <div class="row mb-4">
            <div class="col-12">
                <div class="card">
                    <div class="card-body">
                        <div class="row align-items-center">
                            <div class="col-md-3">
                                <label for="startDate" class="form-label">Start Date</label>
                                <input type="date" class="form-control" id="startDate" th:value="${weekStart}">
                            </div>
                            <div class="col-md-3">
                                <label for="endDate" class="form-label">End Date</label>
                                <input type="date" class="form-control" id="endDate" th:value="${weekEnd}">
                            </div>
                            <div class="col-md-3">
                                <button id="loadEvents" class="btn btn-primary">
                                    <i class="fas fa-search me-1"></i>Load Events
                                </button>
                            </div>
                            <div class="col-md-3">
                                <div class="loading-spinner">
                                    <i class="fas fa-spinner fa-spin me-2"></i>Loading...
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Dashboard Content -->
        <div class="row">
            <!-- Upcoming Events -->
            <div class="col-lg-8">
                <div class="card">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <h5><i class="fas fa-calendar-alt me-2"></i>Upcoming Events</h5>
                        <span id="eventCount" class="badge bg-primary">0 events</span>
                    </div>
                    <div class="card-body">
                        <div id="upcomingEventsContainer">
                            <!-- Events will be loaded here -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Resource Allocation Summary -->
            <div class="col-lg-4">
                <div class="card">
                    <div class="card-header">
                        <h5><i class="fas fa-chart-pie me-2"></i>Resource Allocation</h5>
                    </div>
                    <div class="card-body">
                        <div id="resourceAllocationContainer">
                            <!-- Resource allocation will be loaded here -->
                        </div>
                    </div>
                </div>

                <!-- Hall Availability Status -->
                <div class="card mt-3">
                    <div class="card-header">
                        <h5><i class="fas fa-building me-2"></i>Hall Availability</h5>
                    </div>
                    <div class="card-body">
                        <div id="hallAvailabilityContainer">
                            <!-- Hall availability will be loaded here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Staff Assignments & Equipment -->
        <div class="row mt-4">
            <div class="col-lg-6">
                <div class="card">
                    <div class="card-header">
                        <h5><i class="fas fa-users me-2"></i>Staff Assignments</h5>
                    </div>
                    <div class="card-body">
                        <div id="staffAssignmentsContainer">
                            <!-- Staff assignments will be loaded here -->
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-6">
                <div class="card">
                    <div class="card-header">
                        <h5><i class="fas fa-cogs me-2"></i>Equipment Allocations</h5>
                    </div>
                    <div class="card-body">
                        <div id="equipmentAllocationsContainer">
                            <!-- Equipment allocations will be loaded here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Event Details Modal -->
    <div class="modal fade" id="eventDetailsModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Event Details</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body" id="eventDetailsContent">
                    <!-- Event details will be loaded here -->
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary" id="confirmEventBtn">Confirm Event</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Staff Assignment Modal -->
    <div class="modal fade" id="staffAssignmentModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Assign Staff to Event</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="staffAssignmentForm">
                        <input type="hidden" id="eventId" name="eventId">
                        <div class="mb-3">
                            <label for="staffSelect" class="form-label">Select Staff</label>
                            <select class="form-select" id="staffSelect" name="staffId" required>
                                <option value="">Choose staff member...</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="role" class="form-label">Role</label>
                            <input type="text" class="form-control" id="role" name="role" required>
                        </div>
                        <div class="mb-3">
                            <label for="assignedHours" class="form-label">Assigned Hours</label>
                            <input type="number" class="form-control" id="assignedHours" name="assignedHours" min="1" max="12" required>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <label for="startTime" class="form-label">Start Time</label>
                                <input type="time" class="form-control" id="startTime" name="startTime" required>
                            </div>
                            <div class="col-md-6">
                                <label for="endTime" class="form-label">End Time</label>
                                <input type="time" class="form-control" id="endTime" name="endTime" required>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" id="assignStaffBtn">Assign Staff</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Equipment Assignment Modal -->
    <div class="modal fade" id="equipmentAssignmentModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Assign Equipment to Event</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="equipmentAssignmentForm">
                        <input type="hidden" id="equipmentEventId" name="eventId">
                        <div class="mb-3">
                            <label for="equipmentName" class="form-label">Equipment Name</label>
                            <input type="text" class="form-control" id="equipmentName" name="equipmentName" required>
                        </div>
                        <div class="mb-3">
                            <label for="equipmentType" class="form-label">Equipment Type</label>
                            <select class="form-select" id="equipmentType" name="equipmentType" required>
                                <option value="">Choose type...</option>
                                <option value="Audio">Audio</option>
                                <option value="Visual">Visual</option>
                                <option value="Furniture">Furniture</option>
                                <option value="Catering">Catering</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="quantity" class="form-label">Quantity</label>
                            <input type="number" class="form-control" id="quantity" name="quantity" min="1" required>
                        </div>
                        <div class="mb-3">
                            <label for="unitCost" class="form-label">Unit Cost ($)</label>
                            <input type="number" class="form-control" id="unitCost" name="unitCost" step="0.01" min="0" required>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" id="assignEquipmentBtn">Assign Equipment</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        let refreshInterval;
        let currentEventId = null;

        document.addEventListener('DOMContentLoaded', function() {
            initializeDashboard();
            setupEventListeners();
        });

        function initializeDashboard() {
            loadEventData();
            startRealTimeUpdates();
        }

        function setupEventListeners() {
            // Refresh data button
            document.getElementById('refreshData').addEventListener('click', function() {
                loadEventData();
            });

            // Load events button
            document.getElementById('loadEvents').addEventListener('click', function() {
                loadEventData();
            });

            // Check conflicts button
            document.getElementById('checkConflicts').addEventListener('click', function() {
                checkHallConflicts();
            });

            // Staff assignment form
            document.getElementById('assignStaffBtn').addEventListener('click', function() {
                assignStaffToEvent();
            });

            // Equipment assignment form
            document.getElementById('assignEquipmentBtn').addEventListener('click', function() {
                assignEquipmentToEvent();
            });

            // Confirm event button
            document.getElementById('confirmEventBtn').addEventListener('click', function() {
                confirmEventSchedule();
            });
        }

        function startRealTimeUpdates() {
            // Refresh data every 30 seconds
            refreshInterval = setInterval(loadEventData, 30000);
        }

        function loadEventData() {
            const startDate = document.getElementById('startDate').value;
            const endDate = document.getElementById('endDate').value;
            
            showLoading(true);
            
            fetch(`/banquet/api/events?startDate=${startDate}&endDate=${endDate}`)
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        updateDashboard(data.data);
                        setConnectionStatus(true);
                    } else {
                        showAlert('error', data.error);
                        setConnectionStatus(false);
                    }
                })
                .catch(error => {
                    showAlert('error', 'Failed to load event data: ' + error.message);
                    setConnectionStatus(false);
                })
                .finally(() => {
                    showLoading(false);
                });
        }

        function updateDashboard(data) {
            updateUpcomingEvents(data.upcomingEvents);
            updateResourceAllocation(data.equipmentAllocations);
            updateHallAvailability(data.conflicts);
            updateStaffAssignments(data.staffAssignments);
            updateEquipmentAllocations(data.equipmentAllocations);
        }

        function updateUpcomingEvents(events) {
            const container = document.getElementById('upcomingEventsContainer');
            const countElement = document.getElementById('eventCount');
            
            countElement.textContent = `${events.length} events`;
            
            if (!events || events.length === 0) {
                container.innerHTML = `
                    <div class="text-center py-4">
                        <i class="fas fa-calendar-times fa-3x text-muted mb-3"></i>
                        <p class="text-muted">No upcoming events found</p>
                    </div>
                `;
                return;
            }

            let html = '';
            events.forEach(event => {
                const statusClass = event.status.toLowerCase().replace('_', '-');
                const eventDate = new Date(event.eventDate).toLocaleDateString();
                const startTime = event.startTime;
                const endTime = event.endTime;
                
                html += `
                    <div class="event-card ${statusClass}" onclick="showEventDetails(${event.id})">
                        <div class="d-flex justify-content-between align-items-start">
                            <div>
                                <h6 class="mb-1">${event.event.eventName}</h6>
                                <p class="text-muted mb-1">${event.clientName} • ${event.guestCount} guests</p>
                                <small class="text-muted">
                                    <i class="fas fa-calendar me-1"></i>${eventDate} 
                                    <i class="fas fa-clock me-1 ms-2"></i>${startTime} - ${endTime}
                                </small>
                            </div>
                            <div class="text-end">
                                <span class="badge bg-${getStatusColor(event.status)} status-badge">${event.status}</span>
                                <div class="mt-2">
                                    <button class="btn btn-sm btn-outline-primary me-1" onclick="event.stopPropagation(); assignStaff(${event.id})">
                                        <i class="fas fa-user-plus"></i>
                                    </button>
                                    <button class="btn btn-sm btn-outline-secondary me-1" onclick="event.stopPropagation(); assignEquipment(${event.id})">
                                        <i class="fas fa-cogs"></i>
                                    </button>
                                    <button class="btn btn-sm btn-outline-success" onclick="event.stopPropagation(); confirmEvent(${event.id})">
                                        <i class="fas fa-check"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }

        function updateResourceAllocation(equipment) {
            const container = document.getElementById('resourceAllocationContainer');
            
            if (!equipment || equipment.length === 0) {
                container.innerHTML = '<p class="text-muted">No equipment allocated</p>';
                return;
            }

            // Group equipment by type
            const groupedEquipment = equipment.reduce((acc, item) => {
                if (!acc[item.equipmentType]) {
                    acc[item.equipmentType] = 0;
                }
                acc[item.equipmentType] += item.quantity;
                return acc;
            }, {});

            let html = '';
            Object.entries(groupedEquipment).forEach(([type, quantity]) => {
                html += `
                    <div class="resource-summary">
                        <div class="d-flex justify-content-between">
                            <span>${type}</span>
                            <span class="badge bg-primary">${quantity}</span>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }

        function updateHallAvailability(conflicts) {
            const container = document.getElementById('hallAvailabilityContainer');
            
            if (!conflicts || conflicts.length === 0) {
                container.innerHTML = `
                    <div class="text-success">
                        <i class="fas fa-check-circle me-2"></i>No conflicts detected
                    </div>
                `;
                return;
            }

            let html = `
                <div class="conflict-alert">
                    <h6><i class="fas fa-exclamation-triangle me-2"></i>Hall Conflicts Detected</h6>
                    <p>${conflicts.length} conflicting bookings found</p>
                    <button class="btn btn-sm btn-warning" onclick="checkHallConflicts()">View Details</button>
                </div>
            `;
            
            container.innerHTML = html;
        }

        function updateStaffAssignments(assignments) {
            const container = document.getElementById('staffAssignmentsContainer');
            
            if (!assignments || assignments.length === 0) {
                container.innerHTML = '<p class="text-muted">No staff assignments</p>';
                return;
            }

            let html = '';
            assignments.forEach(assignment => {
                html += `
                    <div class="staff-assignment">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <strong>${assignment.staff.name}</strong>
                                <br>
                                <small class="text-muted">${assignment.role} • ${assignment.assignedHours}h</small>
                            </div>
                            <span class="badge bg-${getAssignmentStatusColor(assignment.status)}">${assignment.status}</span>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }

        function updateEquipmentAllocations(equipment) {
            const container = document.getElementById('equipmentAllocationsContainer');
            
            if (!equipment || equipment.length === 0) {
                container.innerHTML = '<p class="text-muted">No equipment allocated</p>';
                return;
            }

            let html = '';
            equipment.forEach(item => {
                html += `
                    <div class="equipment-item">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <strong>${item.equipmentName}</strong>
                                <br>
                                <small class="text-muted">${item.equipmentType} • Qty: ${item.quantity}</small>
                            </div>
                            <div class="text-end">
                                <span class="badge bg-${getEquipmentStatusColor(item.status)}">${item.status}</span>
                                <br>
                                <small class="text-muted">$${item.totalCost}</small>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }

        function showEventDetails(eventId) {
            currentEventId = eventId;
            // Load event details and show modal
            const modal = new bootstrap.Modal(document.getElementById('eventDetailsModal'));
            modal.show();
        }

        function assignStaff(eventId) {
            currentEventId = eventId;
            document.getElementById('eventId').value = eventId;
            
            // Load available staff
            const startDate = document.getElementById('startDate').value;
            fetch(`/banquet/staff/available?eventDate=${startDate}`)
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        const select = document.getElementById('staffSelect');
                        select.innerHTML = '<option value="">Choose staff member...</option>';
                        data.staff.forEach(staff => {
                            const option = document.createElement('option');
                            option.value = staff.id;
                            option.textContent = staff.name;
                            select.appendChild(option);
                        });
                    }
                });
            
            const modal = new bootstrap.Modal(document.getElementById('staffAssignmentModal'));
            modal.show();
        }

        function assignEquipment(eventId) {
            currentEventId = eventId;
            document.getElementById('equipmentEventId').value = eventId;
            
            const modal = new bootstrap.Modal(document.getElementById('equipmentAssignmentModal'));
            modal.show();
        }

        function confirmEvent(eventId) {
            currentEventId = eventId;
            
            fetch(`/banquet/events/${eventId}/confirm`, {
                method: 'POST'
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showAlert('success', 'Event schedule confirmed successfully');
                    loadEventData();
                } else {
                    showAlert('error', data.error);
                }
            })
            .catch(error => {
                showAlert('error', 'Failed to confirm event: ' + error.message);
            });
        }

        function assignStaffToEvent() {
            const form = document.getElementById('staffAssignmentForm');
            const formData = new FormData(form);
            const data = Object.fromEntries(formData.entries());
            
            fetch(`/banquet/events/${data.eventId}/assign-staff`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(data)
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showAlert('success', 'Staff assigned successfully');
                    bootstrap.Modal.getInstance(document.getElementById('staffAssignmentModal')).hide();
                    loadEventData();
                } else {
                    showAlert('error', data.error);
                }
            })
            .catch(error => {
                showAlert('error', 'Failed to assign staff: ' + error.message);
            });
        }

        function assignEquipmentToEvent() {
            const form = document.getElementById('equipmentAssignmentForm');
            const formData = new FormData(form);
            const data = Object.fromEntries(formData.entries());
            
            fetch(`/banquet/events/${data.eventId}/assign-equipment`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(data)
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showAlert('success', 'Equipment assigned successfully');
                    bootstrap.Modal.getInstance(document.getElementById('equipmentAssignmentModal')).hide();
                    loadEventData();
                } else {
                    showAlert('error', data.error);
                }
            })
            .catch(error => {
                showAlert('error', 'Failed to assign equipment: ' + error.message);
            });
        }

        function confirmEventSchedule() {
            if (currentEventId) {
                confirmEvent(currentEventId);
            }
        }

        function checkHallConflicts() {
            const startDate = document.getElementById('startDate').value;
            
            fetch(`/banquet/availability?date=${startDate}`)
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        if (data.conflicts && data.conflicts.length > 0) {
                            showAlert('warning', `Found ${data.conflicts.length} hall conflicts`);
                        } else {
                            showAlert('success', 'No hall conflicts detected');
                        }
                    } else {
                        showAlert('error', data.error);
                    }
                })
                .catch(error => {
                    showAlert('error', 'Failed to check conflicts: ' + error.message);
                });
        }

        function getStatusColor(status) {
            switch(status) {
                case 'CONFIRMED': return 'success';
                case 'PENDING': return 'warning';
                case 'CANCELLED': return 'danger';
                case 'IN_PROGRESS': return 'info';
                default: return 'secondary';
            }
        }

        function getAssignmentStatusColor(status) {
            switch(status) {
                case 'ASSIGNED': return 'primary';
                case 'CONFIRMED': return 'success';
                case 'IN_PROGRESS': return 'info';
                case 'COMPLETED': return 'success';
                case 'CANCELLED': return 'danger';
                default: return 'secondary';
            }
        }

        function getEquipmentStatusColor(status) {
            switch(status) {
                case 'REQUESTED': return 'warning';
                case 'CONFIRMED': return 'success';
                case 'SETUP': return 'info';
                case 'IN_USE': return 'primary';
                case 'CLEANUP': return 'warning';
                case 'RETURNED': return 'success';
                case 'DAMAGED': return 'danger';
                default: return 'secondary';
            }
        }

        function showAlert(type, message) {
            const alertContainer = document.getElementById('alertContainer');
            const alertClass = type === 'error' ? 'danger' : type;
            
            const alertHtml = `
                <div class="alert alert-${alertClass} alert-dismissible fade show" role="alert">
                    ${message}
                    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                </div>
            `;
            
            alertContainer.innerHTML = alertHtml;
            
            // Auto-dismiss after 5 seconds
            setTimeout(() => {
                const alert = alertContainer.querySelector('.alert');
                if (alert) {
                    bootstrap.Alert.getOrCreateInstance(alert).close();
                }
            }, 5000);
        }

        function setConnectionStatus(connected) {
            const statusElement = document.getElementById('connectionStatus');
            if (connected) {
                statusElement.className = 'badge bg-success';
                statusElement.innerHTML = '<i class="fas fa-circle me-1"></i>Live';
            } else {
                statusElement.className = 'badge bg-danger';
                statusElement.innerHTML = '<i class="fas fa-circle me-1"></i>Offline';
            }
        }

        function showLoading(show) {
            const spinner = document.querySelector('.loading-spinner');
            if (show) {
                spinner.classList.add('show');
            } else {
                spinner.classList.remove('show');
            }
        }
    </script>
</body>
</html>
